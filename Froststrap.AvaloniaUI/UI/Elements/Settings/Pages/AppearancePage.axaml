<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="450"
             x:Class="Froststrap.UI.Elements.Settings.Pages.AppearancePage"
             xmlns:vm="clr-namespace:Froststrap.UI.ViewModels.Settings"
             xmlns:controls="clr-namespace:Froststrap.UI.Elements.Controls"
             xmlns:resources="using:Froststrap.Resources"
             x:DataType="vm:AppearanceViewModel"
             >
    <ScrollViewer>
        <StackPanel Spacing="8">
            <StackPanel Margin="0,0,14,14">
                <TextBlock Text="{x:Static resources:Strings.Menu_Appearance_Description}" FontSize="14" Foreground="White" Margin="0,0,0,8" />
                <Expander Margin="0,8,0,0" IsExpanded="{Binding CustomGlobalThemeExpanded, Mode=OneWay}">
                    <Expander.Header>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            
                            <StackPanel>
                                <TextBlock FontSize="14" Text="{x:Static resources:Strings.Menu_Appearance_Custom_Theme_Title}" />
                                <TextBlock FontSize="12" Text="{x:Static resources:Strings.Menu_Appearance_Custom_Theme_Description}" Foreground="{DynamicResource TextFillColorTertiaryBrush}" />
                            </StackPanel>
                            
                            <ComboBox Width="200" Padding="10,5,10,5" ItemsSource="{Binding Themes}" SelectedItem="{Binding Theme, Mode=TwoWay}" Grid.Column="1">
                                <ComboBox.ItemTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding Converter={StaticResource EnumNameConverter}}" />
                                    </DataTemplate>
                                </ComboBox.ItemTemplate>
                            </ComboBox>
                        </Grid>
                    </Expander.Header>
                    
                    <StackPanel>
                        <StackPanel Margin="0,0,0,12">
                            <TextBlock Text="Background Mode:" FontSize="14" FontWeight="SemiBold" Margin="0,0,0,8"/>
                            <ComboBox ItemsSource="{Binding BackgroundTypes}" SelectedItem="{Binding BackgroundType, Mode=TwoWay}">
                                <ComboBox.ItemTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding Converter={StaticResource EnumNameConverter}}"/>
                                    </DataTemplate>
                                </ComboBox.ItemTemplate>
                            </ComboBox>
                        </StackPanel>
                        
                        <Separator Margin="0,8"/>
                        
                        <StackPanel IsVisible="{Binding IsGradientMode, Converter={StaticResource BooleanToVisibilityConverter}}">
                            <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Margin="0,0,0,4">
                                <TextBlock Text="Gradient Stops:" FontSize="16" FontWeight="SemiBold" VerticalAlignment="Center"/>
                            </StackPanel>
                            
                            <ItemsControl ItemsSource="{Binding GradientStops}">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Grid Margin="0,2" HorizontalAlignment="Stretch">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="110"/>
                                        <ColumnDefinition Width="110"/>
                                        <ColumnDefinition Width="100"/>
                                    </Grid.ColumnDefinitions>

                                    <TextBlock Text="Offset:" VerticalAlignment="Center" Margin="4,0,4,0" Grid.Column="0"/>
                                    <Slider Minimum="0"
                                            Maximum="1"
                                            Value="{Binding Offset, Mode=TwoWay}"
                                            TickFrequency="0.01"
                                            IsSnapToTickEnabled="True"
                                            Margin="4,8,4,8"
                                            Grid.Column="1"
                                            PointerReleased="OnSliderReleased"/>
                                    <TextBlock Text="{Binding Offset, StringFormat=F2}" VerticalAlignment="Center" Margin="8,0,8,0" Width="30" Grid.Column="2"/>
                                    <TextBox Text="{Binding Color, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" HorizontalAlignment="Stretch" Margin="0,0,8,0" VerticalAlignment="Center" TextChanged="OnGradientColorHexChanged" Grid.Column="3" MinWidth="100"/>
                                    <Button Content="Color Picker" Margin="0,0,4,0" Tag="{Binding}" HorizontalAlignment="Stretch" Click="OnChangeGradientColor_Click" Grid.Column="4"/>
                                    <Button Content="Remove" Margin="0,0,0,0" Tag="{Binding}" HorizontalAlignment="Stretch" Click="OnRemoveGradientStop_Click" Grid.Column="5"/>
                                </Grid>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                            <Grid Margin="0,12,0,0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <StackPanel Orientation="Horizontal" Grid.Column="0">
                                    <Button Content="Export Gradient" Click="OnExportGradient_Click" Margin="4"/>
                                    <Button Content="Import Gradient" Click="OnImportGradient_Click" Margin="4"/>
                                </StackPanel>
                                <StackPanel Orientation="Horizontal" Grid.Column="2">
                                    <TextBlock Text="Gradient Angle:" VerticalAlignment="Center" Margin="0,0,4,0"/>
                                    <TextBox Text="{Binding GradientAngle, Mode=TwoWay, UpdateSourceTrigger=LostFocus}" Width="50" Margin="4"/>
                                    <Button Content="Reset to Default" Click="OnResetGradient_Click" Margin="4" />
                                    <Button Content="Add Gradient Color" Click="OnAddGradientStop_Click" Margin="4"/>
                                </StackPanel>
                            </Grid>
                        </StackPanel>
                        
                        <StackPanel IsVisible="{Binding IsImageMode, Converter={StaticResource BooleanToVisibilityConverter}}" Margin="0,12,0,0">
                            <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Margin="0,0,0,12">
                                <TextBlock Text="Background Image:" FontSize="16" FontWeight="SemiBold" VerticalAlignment="Center"/>
                            </StackPanel>
                            
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                                <Button Content="Select Image" Click="OnSelectBackgroundImage_Click" Margin="0,0,8,0"/>
                                <Button Content="Clear Image" Click="OnClearBackgroundImage_Click" Margin="8,0,0,0"/>
                            </StackPanel>
                            
                            <StackPanel Margin="0,12,0,0">
                                <TextBlock Text="Image Stretch:" FontSize="14" FontWeight="SemiBold" Margin="0,0,0,8"/>
                                <ComboBox ItemsSource="{Binding BackgroundStretches}" SelectedItem="{Binding BackgroundStretch, Mode=TwoWay}">
                                    <ComboBox.ItemTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="{Binding Converter={StaticResource EnumNameConverter}}"/>
                                        </DataTemplate>
                                    </ComboBox.ItemTemplate>
                                </ComboBox>
                            </StackPanel>
                            
                            <StackPanel Margin="0,12,0,0">
                                <TextBlock Text="Image Opacity:" FontSize="14" FontWeight="SemiBold" Margin="0,0,0,8"/>
                                <Slider Minimum="0" Maximum="100" Value="{Binding BackgroundOpacity, Mode=TwoWay}" PreviewMouseLeftButtonUp="OnSliderReleased" TickFrequency="1" IsSnapToTickEnabled="True" AutoToolTipPlacement="TopLeft" AutoToolTipPrecision="0"/>
                            </StackPanel>
                        </StackPanel>
                    </StackPanel>
                </Expander>
                
                <controls:OptionControl
                    Header="{x:Static resources:Strings.Menu_Appearance_WindowsBackdrop_Title}" 
                    Description="{x:Static resources:Strings.Menu_Appearance_WindowsBackdrop_Description}">
                    <ComboBox
                        Width="200"
                        Margin="5,0,0,0"
                        Padding="10,5,10,5"
                        SelectionChanged="WindowsBackdropChangeSelectionChanged"
                        ItemsSource="{Binding BackdropOptions}"
                        SelectedItem="{Binding SelectedBackdrop, Mode=TwoWay}" />
                </controls:OptionControl>
                
                <controls:OptionControl
                    Header="{x:Static resources:Strings.Menu_Appearance_CustomAppFont_Title}"
                    Description="{x:Static resources:Strings.Menu_Appearance_CustomAppFont_Description}"
                >
                    <StackPanel>
                        <Button 
                            Content="Choose Font"
                            Command="{Binding ManageCustomFontCommand}"
                            CommandParameter="Choose"
                            IsVisible="{Binding ChooseCustomFontVisibility, Mode=OneWay}"
                            />
                        <Button
                            Content="Remove Font"
                            Command="{Binding ManageCustomFontCommand}"
                            CommandParameter="Remove"
                            IsVisible="{Binding DeleteCustomFontVisibility, Mode=OneWay}" />
                    </StackPanel>
                </controls:OptionControl>
                
                <controls:OptionControl
                    Header="{x:Static resources:Strings.Menu_Appearance_Language_Title}"
                    Description="{x:Static resources:Strings.Menu_Appearance_Language_Description}">
                    <ComboBox Width="200" Padding="10,5,10,5" ItemsSource="{Binding Languages, Mode=OneTime}" Text="{Binding SelectedLanguage, Mode=TwoWay}" />
                </controls:OptionControl>
                
                <Expander Margin="0,8,0,0">
                    <Expander.Header>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock FontSize="14" Text="{x:Static resources:Strings.Menu_Appearance_MenuAdjustment_Title}" />
                                <TextBlock FontSize="12" Text="{x:Static resources:Strings.Menu_Appearance_MenuAdjustment_Description}" Foreground="{DynamicResource TextFillColorTertiaryBrush}" />
                            </StackPanel>
                        </Grid>
                    </Expander.Header>
                    
                    <Grid Margin="0,8,0,0" MinHeight="325">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="*" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        
                        <ListBox x:Name="ListBoxNavigationItems" Grid.Row="0" Margin="0,0,0,8" SelectedIndex="0" HorizontalContentAlignment="Stretch">
                            <ListBox.ItemTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding }" Padding="4,2"  />
                                </DataTemplate>
                            </ListBox.ItemTemplate>
                        </ListBox>
                        
                            <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,8,0,0" HorizontalAlignment="Left">
                    <Button x:Name="MoveUpButton" Content="{x:Static resources:Strings.Menu_Appearance_MenuAdjustment_MoveUp}" Click="MoveUp_Click" Margin="0,0,8,0"  />
                    <Button x:Name="MoveDownButton" Content="{x:Static resources:Strings.Menu_Appearance_MenuAdjustment_MoveDown}" Click="MoveDown_Click" Margin="0,0,8,0"  />
                    <Button x:Name="ResetToDefaultButton" Content="{x:Static resources:Strings.Menu_Appearance_MenuAdjustment_ResetToDefault}" Click="ResetOrder_Click" Margin="0,0,8,0"  />
                    <ToggleButton x:Name="ToggleLockOrder" Content="{x:Static resources:Strings.Menu_Appearance_MenuAdjustment_LockOrder}" IsCheckedChanged="ToggleLockOrder_IsCheckedChanged" />
                </StackPanel>
                    </Grid>
                </Expander>
                
                <Separator Margin="0,8,0,4"/>
                
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="128" />
                    </Grid.ColumnDefinitions>
                    <StackPanel Grid.Column="0" VerticalAlignment="Bottom">
                        <TextBlock Text="{x:Static resources:Strings.Menu_Appearance_Bootstrapper_Title}" FontSize="20" FontWeight="Bold" VerticalAlignment="Bottom" />
                        <TextBlock Text="{x:Static resources:Strings.Menu_Appearance_Bootstrapper_Description}" TextWrapping="Wrap" Foreground="{DynamicResource TextFillColorSecondaryBrush}" />
                    </StackPanel>
                    <Button Grid.Column="1" Content="{x:Static resources:Strings.Menu_Appearance_Preview}"  HorizontalAlignment="Stretch" Margin="0,16,0,0" Command="{Binding PreviewBootstrapperCommand}" />
                </Grid>
                
                <Expander Margin="0,8,0,0" IsExpanded="{Binding Path=CustomThemesExpanded, Mode=OneWay}" Styles="{StaticResource NoUserExpansionCardExpanderStyle}">
                    <Expander.Header>
                        <Grid>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <StackPanel Grid.Column="0">
                                    <TextBlock FontSize="14" Text="{x:Static resources:Strings.Menu_Appearance_Launcher_Title}"  />
                                    <TextBlock FontSize="12" Text="{x:Static resources:Strings.Menu_Appearance_Launcher_Description}" Foreground="{DynamicResource TextFillColorTertiaryBrush}"  />
                                </StackPanel>
                                <ComboBox Width="200" Padding="10,5,10,5" ItemsSource="{Binding Dialogs, Mode=OneTime}" Text="{Binding Dialog, Mode=TwoWay}" Grid.Column="1">
                                    <ComboBox.ItemTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="{Binding Path=., Converter={StaticResource EnumNameConverter}}" />
                                        </DataTemplate>
                                    </ComboBox.ItemTemplate>
                                </ComboBox>
                            </Grid>
                        </Grid>
                    </Expander.Header>
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="*" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="250" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        
                        <ListBox x:Name="CustomThemesListBox" Height="265" Grid.Row="0" Grid.Column="0" Margin="0,2,4,38" ItemsSource="{Binding CustomThemes, Mode=OneWay}" SelectionChanged="CustomThemeSelection" SelectedIndex="{Binding SelectedCustomThemeIndex, Mode=TwoWay}" Grid.RowSpan="2" />
                        
                        <Grid Grid.Row="1" Grid.Column="0" Margin="0,8,4,0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>
                            <Button Grid.Column="0" Margin="0,0,4,0" Content="{x:Static resources:Strings.Common_New}" HorizontalAlignment="Stretch" Command="{Binding AddCustomThemeCommand, Mode=OneTime}"  />
                            <Button Grid.Column="1" Margin="4,0,0,0" Content="{x:Static resources:Strings.Common_Delete}" HorizontalAlignment="Stretch" Appearance="Danger" IsEnabled="{Binding IsCustomThemeSelected, Mode=OneWay}" Command="{Binding DeleteCustomThemeCommand, Mode=OneTime}"  />
                        </Grid>
                        <StackPanel Grid.Row="0" Grid.RowSpan="2" Grid.Column="1" Margin="4,0,0,0">
                            <StackPanel.Styles>
                                <Style>
                                    <!-- TODO: Convert to Avalonia -->
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding IsCustomThemeSelected}" Value="False">
                                            <Setter Property="StackPanel.Visibility" Value="Hidden"/>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </StackPanel.Styles>
                            
                            <TextBlock Text="{x:Static resources:Strings.Common_Name}" Foreground="{DynamicResource TextFillColorSecondaryBrush}" />
                            
                            <TextBox Margin="0,4,0,0" Text="{Binding SelectedCustomThemeName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                            
                            <Grid Margin="0,8,0,0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>

                                <Button Grid.Column="0" Margin="0,0,4,0" Content="{x:Static resources:Strings.Common_Rename}" HorizontalAlignment="Stretch" Command="{Binding RenameCustomThemeCommand, Mode=OneTime}"  />
                                <Button Grid.Column="1" Margin="4,0,4,0" Content="{x:Static resources:Strings.Common_Edit}" HorizontalAlignment="Stretch" Command="{Binding EditCustomThemeCommand, Mode=OneTime}"  />
                                <Button Grid.Column="2" Margin="4,0,0,0" Content="{x:Static resources:Strings.Common_Export}" HorizontalAlignment="Stretch" Command="{Binding ExportCustomThemeCommand, Mode=OneTime}"  />
                            </Grid>
                        </StackPanel>
                        
                        <TextBlock Grid.Row="0" Grid.RowSpan="2" Grid.Column="1" Text="{x:Static resources:Strings.Menu_Appearance_CustomThemes_NoneSelected}" TextWrapping="Wrap" VerticalAlignment="Center" HorizontalAlignment="Center" >
                            <TextBlock.Style>
                                <Style>
                                    <!-- TODO: Convert to Avalonia -->
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding IsCustomThemeSelected}" Value="True">
                                            <Setter Property="TextBlock.Visibility" Value="Hidden"></Setter>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </TextBlock.Style>
                        </TextBlock>
                    </Grid>
                </Expander>
                
                <controls:OptionControl 
                    x:Name="IconSelector"
                    Header="{x:Static resources:Strings.Menu_Appearance_Icon_Title}" 
                    Description="{x:Static resources:Strings.Menu_Appearance_Icon_Description}">
                    <ComboBox Width="200" Padding="10,5,10,5" ItemsSource="{Binding Icons, Mode=OneWay}" SelectedValuePath="IconType" SelectedValue="{Binding Icon, Mode=TwoWay}">
                        <ComboBox.ItemTemplate>
                            <DataTemplate>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="16" />
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>
                                    <Image Height="16" Source="{Binding ImageSource, Mode=OneWay}" RenderOptions.BitmapScalingMode="HighQuality" />
                                    <TextBlock Grid.Column="1" Margin="8,0,0,0" Text="{Binding Path=IconType, Converter={StaticResource EnumNameConverter}}" />
                                </Grid>
                            </DataTemplate>
                        </ComboBox.ItemTemplate>
                    </ComboBox>
                </controls:OptionControl>
                
                <Expander Margin="0,8,0,0" IsExpanded="False">
                    <Expander.Header>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock FontSize="14" Text="{x:Static resources:Strings.Menu_Appearance_Customisation_Title}"  />
                                <TextBlock FontSize="12" Text="{x:Static resources:Strings.Menu_Appearance_Customisation_Description}" Foreground="{DynamicResource TextFillColorTertiaryBrush}"  />
                            </StackPanel>
                        </Grid>
                    </Expander.Header>
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="*" />
                            <RowDefinition Height="*" />
                            <RowDefinition Height="*" />
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="180" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        
                       <TextBlock Grid.Row="0" Grid.Column="0" Text="{x:Static resources:Strings.Menu_Appearance_CustomisationTitle_Title}" VerticalAlignment="Center" Foreground="{DynamicResource TextFillColorSecondaryBrush}" />
                       <TextBox Grid.Column="1" Text="{Binding Title, Mode=TwoWay}" />
                       <TextBlock Grid.Row="1" Grid.Column="1" Margin="0,4,0,0" FontSize="12" Text="{x:Static resources:Strings.Menu_Appearance_CustomisationTitle_Description}"  Foreground="{DynamicResource TextFillColorTertiaryBrush}" />
                       <TextBlock Grid.Row="2" Grid.Column="0" Margin="0,12,0,0"  Text="{x:Static resources:Strings.Menu_Appearance_CustomisationIcon_Title}" TextWrapping="Wrap" VerticalAlignment="Center"  Foreground="{DynamicResource TextFillColorSecondaryBrush}" />
                       
                       <Grid Grid.Row="2" Grid.Column="1" Margin="0,12,0,0">
                           <Grid.ColumnDefinitions>
                               <ColumnDefinition Width="*" />
                               <ColumnDefinition Width="Auto" />
                           </Grid.ColumnDefinitions>
                           <TextBox Grid.Column="0" Margin="0,0,4,0" Text="{Binding CustomIconLocation, Mode=TwoWay}" />
                           <TextBox Grid.Column="1" Margin="4,0,0,0" Height="35"  Text="{x:Static resources:Strings.Common_Browse}" PointerReleased="{Binding BrowseCustomIconLocationCommand}"  />
                       </Grid>
                       
                       <TextBlock Grid.Row="3" Grid.Column="1" Margin="0,4,0,0" FontSize="12" Text="{x:Static resources:Strings.Menu_Appearance_CustomisationIcon_Description}" TextWrapping="Wrap" Foreground="{DynamicResource TextFillColorTertiaryBrush}" />
                    </Grid>
                </Expander>
            </StackPanel>
        </StackPanel>
    </ScrollViewer>
</UserControl>
